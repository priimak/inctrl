
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../name_resolution/">
      
      
        <link rel="next" href="../waveform/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.6">
    
    
      
        <title>Oscilloscope API - InCtrl</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#oscilloscope" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="InCtrl" class="md-header__button md-logo" aria-label="InCtrl" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            InCtrl
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Oscilloscope API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="InCtrl" class="md-nav__button md-logo" aria-label="InCtrl" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    InCtrl
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../supported_instruments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supported instruments
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../name_resolution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Name and params resolution
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Oscilloscope API
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Oscilloscope API
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#instantiation" class="md-nav__link">
    <span class="md-ellipsis">
      Instantiation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Capabilities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interacting-with-the-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Interacting with the scope
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interacting with the scope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scope-as-a-whole" class="md-nav__link">
    <span class="md-ellipsis">
      Scope as a whole
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel" class="md-nav__link">
    <span class="md-ellipsis">
      Channel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#coupling" class="md-nav__link">
    <span class="md-ellipsis">
      Coupling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertical-scaling-and-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Vertical scaling and offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#impedance" class="md-nav__link">
    <span class="md-ellipsis">
      Impedance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downloading-waveform" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading waveform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trigger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#capturing-i2c-data" class="md-nav__link">
    <span class="md-ellipsis">
      Capturing I2C data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../waveform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Waveform
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../duration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Duration
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#instantiation" class="md-nav__link">
    <span class="md-ellipsis">
      Instantiation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Capabilities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interacting-with-the-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Interacting with the scope
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interacting with the scope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scope-as-a-whole" class="md-nav__link">
    <span class="md-ellipsis">
      Scope as a whole
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel" class="md-nav__link">
    <span class="md-ellipsis">
      Channel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#coupling" class="md-nav__link">
    <span class="md-ellipsis">
      Coupling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertical-scaling-and-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Vertical scaling and offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#impedance" class="md-nav__link">
    <span class="md-ellipsis">
      Impedance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downloading-waveform" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading waveform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trigger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#capturing-i2c-data" class="md-nav__link">
    <span class="md-ellipsis">
      Capturing I2C data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="oscilloscope">Oscilloscope<a class="headerlink" href="#oscilloscope" title="Permanent link">&para;</a></h1>
<h2 id="instantiation">Instantiation<a class="headerlink" href="#instantiation" title="Permanent link">&para;</a></h2>
<p>Oscilloscope class is instantiated like so</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">inctrl</span><span class="w"> </span><span class="kn">import</span> <span class="n">oscilloscope</span><span class="p">,</span> <span class="n">Oscilloscope</span>

<span class="n">scope</span><span class="p">:</span> <span class="n">Oscilloscope</span> <span class="o">=</span> <span class="n">oscilloscope</span><span class="p">(</span><span class="s2">&quot;$address&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Address argument allows to access a particular oscilloscope connected to your computer or present on the network.
This address string could be a <a href="https://en.wikipedia.org/wiki/Virtual_instrument_software_architecture">VISA</a> address
or an alias. In the case of alias actual address (and some other parameters) has to be resolved by some means. Details
of that are in the "<a href="../name_resolution/">Instrument name and parameters resolution</a>" page.</p>
<p>Returned object (assigned to the variable <code>scope</code>) is an instance of <code>Oscilloscope</code> class. Which instance, will
depend on identification of the scope or can be forced though name and parameter resolution.</p>
<p>To ensure that oscilloscope to which you are connecting has required properties you can also pass <code>capability</code> argument.
For example, let say you require scope to have 8 channels. You can do it like so:</p>
<div class="highlight"><pre><span></span><code><span class="n">scope</span><span class="p">:</span> <span class="n">Oscilloscope</span> <span class="o">=</span> <span class="n">oscilloscope</span><span class="p">(</span>
    <span class="s2">&quot;$address&quot;</span><span class="p">,</span> <span class="n">capabilities</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;num_channels&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
<p>Another way to ensure that you got instrument and a class that you want is to call <code>scope.as_class(...)</code> method. For
example if you want to ensure that you are working with LeCroy scope you do following.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">inctrl.drivers.oscilloscope</span><span class="w"> </span><span class="kn">import</span> <span class="n">LeCroyOscilloscope</span>

<span class="n">scope</span><span class="p">:</span> <span class="n">LeCroyOscilloscope</span> <span class="o">=</span> <span class="n">oscilloscope</span><span class="p">(</span><span class="s2">&quot;$address&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">as_class</span><span class="p">(</span><span class="n">LeCroyOscilloscope</span><span class="p">)</span>
</code></pre></div>
<p>If oscilloscope that you are connecting here is not a LeCroy scope then calling <code>as_class(LeCroyOscilloscope)</code> will
raise RuntimeError. This way you can ensure you connect to a specific make of the oscilloscope and obtain access to
methods unique to that particual scope.</p>
<h2 id="capabilities">Capabilities<a class="headerlink" href="#capabilities" title="Permanent link">&para;</a></h2>
<p>TBD</p>
<h2 id="interacting-with-the-scope">Interacting with the scope<a class="headerlink" href="#interacting-with-the-scope" title="Permanent link">&para;</a></h2>
<p>An oscilloscope has several logical components, primary being (1) the scope itself as
a whole, (2) channels and (3) a trigger.</p>
<h3 id="scope-as-a-whole">Scope as a whole<a class="headerlink" href="#scope-as-a-whole" title="Permanent link">&para;</a></h3>
<p>At this level you can set time window for scope capture like so:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">inctrl.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Duration</span>

<span class="n">time_window</span><span class="p">:</span> <span class="n">Duration</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">set_time_window</span><span class="p">(</span><span class="s2">&quot;22 us&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Argument to this function is a string containing time interval in the human-readable form or an instance of
class <code>Duration</code>. Since often not every time interval can be set, this function returns actually set duration
for the capture window. However, we guarantee that actually set time window will always be greater or equal
to the requested value and never less.</p>
<p>Alternatively you can set duration per time division, also known as <em>time scale</em></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">inctrl.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Duration</span>

<span class="n">time_per_div</span><span class="p">:</span> <span class="n">Duration</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">set_time_scale</span><span class="p">(</span><span class="s2">&quot;5 us&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Similarly to <code>set_time_window(...)</code> function <code>set_time_scale(...)</code> also returns actually set value.</p>
<p>Configured values can also be retrieved by calling <code>scope.get_time_window()</code> and <code>scope.get_time_scale()</code>.</p>
<h3 id="channel">Channel<a class="headerlink" href="#channel" title="Permanent link">&para;</a></h3>
<p>To obtain handles to a given scope channel you can call <code>scope.channel(...)</code> function. This function accepts
either channel number of channel name. In the later case channel name has to be defined through mechanisms
described in "<a href="../name_resolution/">Instrument name and parameters resolution</a>" page.</p>
<div class="highlight"><pre><span></span><code><span class="n">ch3</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">channel</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clk</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">channel</span><span class="p">(</span><span class="s2">&quot;CLK&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Using these variables you can now interact with this channel and adjust various properties associated it.</p>
<h4 id="coupling">Coupling<a class="headerlink" href="#coupling" title="Permanent link">&para;</a></h4>
<p>Channel coupling can by set by calling <code>set_coupling(coupling: ChannelCoupling, fail_on_error: bool = False)</code> method.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">inctrl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelCoupling</span>

<span class="n">ch3</span><span class="o">.</span><span class="n">set_coupling</span><span class="p">(</span><span class="n">ChannelCoupling</span><span class="o">.</span><span class="n">AC</span><span class="p">)</span>
</code></pre></div>
<p>Not every kind of coupling might be supported on the scope. Possible coupling constants are AC, DC and GND.
If <code>fail_on_error</code> argument is set to False (default), then simply return configured coupling even if unable
to set requested coupling type. If If <code>fail_on_error</code> is True and fail to set requested coupling, then
raise <code>RuntimeError</code>.</p>
<p>Use companion function <code>channel.get_coupling()</code> to obtain currently configured coupling on the channel.</p>
<h4 id="vertical-scaling-and-offset">Vertical scaling and offset<a class="headerlink" href="#vertical-scaling-and-offset" title="Permanent link">&para;</a></h4>
<p>To ensure that signal you are trying to capture does not clip you can call function <code>set_range(...)</code>. This function
is provided as an alternative to setting voltage per division and offset.</p>
<div class="highlight"><pre><span></span><code><span class="n">ch3_Vmin</span><span class="p">,</span> <span class="n">ch3_Vmax</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">set_range_V</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<p>This function guaranteed to set voltage per division and vertical offset such that requested voltage range fits
on the screen. It returns a tuple of actually set min and max values. These will usually match with voltage range
and scope screen. Voltage range as configured on the scope can always be retrieved by calling <code>get_range_V()</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">ch3_Vmin</span><span class="p">,</span> <span class="n">ch3_Vmax</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">get_range_V</span><span class="p">()</span>
</code></pre></div>
<p>Alternatively you can call lower level functions <code>ch.set_offset_V(...)</code> and <code>ch.scale_V(...)</code>
(both return actually set values) and their companions <code>ch.get_offset_V()</code> and <code>ch.get_scale_V()</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">ch3_offset_V</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">set_offset_V</span><span class="p">(</span><span class="mf">0.0023</span><span class="p">)</span>
<span class="n">ch3_V_per_div</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">get_scale_V</span><span class="p">(</span><span class="mf">0.008</span><span class="p">)</span>
</code></pre></div>
<h4 id="impedance">Impedance<a class="headerlink" href="#impedance" title="Permanent link">&para;</a></h4>
<p>Channel input impedance can be set by calling function
<code>set_impedance_oHm(impedance_oHm: float, fail_on_error: bool = False) -&gt; float</code>.
Different oscilloscopes offer different impedance values that can be set. Typically, that is 50 Ohm and 1 MOhm.
Calling this function like so is guaranteed to return actually set impedance value.</p>
<div class="highlight"><pre><span></span><code><span class="n">ch3_impedance</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">set_impedance_oHm</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<p>The above call might behave differently depending on the scope make and model. It might set impedance to the
nearest allowed value or simply reject it keeping whatever configured intact. Users can use returned value to
decide what do to about it. Alternatively call like so will ensure that requested impedance is set or error raised.</p>
<div class="highlight"><pre><span></span><code><span class="n">ch3</span><span class="o">.</span><span class="n">set_impedance_oHm</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">fail_on_error</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>List of allowed impedance values can be obtained from the <code>scope.properties</code> namespace like so</p>
<div class="highlight"><pre><span></span><code><span class="n">allowed_impedance_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get_impedance_list</span><span class="p">()</span>
</code></pre></div>
<p>Alternative to above calls is to call functions</p>
<div class="highlight"><pre><span></span><code><span class="n">ch3_impedance</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">set_impedance_min</span><span class="p">()</span>
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code><span class="n">ch3_impedance</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">set_impedance_max</span><span class="p">()</span>
</code></pre></div>
<p>which set minimum and maximum impedance value valid on a particular scope.</p>
<h4 id="downloading-waveform">Downloading waveform<a class="headerlink" href="#downloading-waveform" title="Permanent link">&para;</a></h4>
<p>When tigger (see below) is configured and enabled on the scope, then waveform can be captured and downloaded
as a <code>Waveform</code> class like so:</p>
<div class="highlight"><pre><span></span><code><span class="n">c1_waveform</span><span class="p">:</span> <span class="n">Waveform</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">get_waveform</span><span class="p">()</span>
</code></pre></div>
<p>Returned object (instance of <code>Waveform</code> class) will have various metadata mostly related to how it is to be rendered.
Among this metadata Waveform will have <em>name</em>. By default, name given to the waveform will be name of the channel if
channel does have a name. If channel does not have a name, but is simply referred to by a number, then waveform name
will be "<em>Channel $channel_number</em>".</p>
<p>To give waveform a custom name you can either call <code>get_waveform($name)</code> with <code>name</code> argument</p>
<div class="highlight"><pre><span></span><code><span class="n">mosi_waveform</span><span class="p">:</span> <span class="n">Waveform</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">get_waveform</span><span class="p">(</span><span class="s2">&quot;mosi&quot;</span><span class="p">)</span>
</code></pre></div>
<p>or set name on the already obtained waveform object</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">inctrl</span><span class="w"> </span><span class="kn">import</span> <span class="n">Waveform</span>

<span class="n">c1_waveform</span><span class="p">:</span> <span class="n">Waveform</span> <span class="o">=</span> <span class="n">ch3</span><span class="o">.</span><span class="n">get_waveform</span><span class="p">()</span>
<span class="n">c1_waveform</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;mosi&quot;</span>
</code></pre></div>
<p>To ensure that you download valid waveform call <code>scope.trigger.wait_for_waveform(...)</code> method (see below).</p>
<h3 id="trigger">Trigger<a class="headerlink" href="#trigger" title="Permanent link">&para;</a></h3>
<p>Interaction with triggers consist of two parts: (a) configuring the trigger and (2) interacting with configured trigger.
All of this is available under <code>scope.trigger</code> namespace.</p>
<h4 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h4>
<p>To configure trigger call function <code>scope.trigger.configure(trigger: ScopeTrigger) -&gt; None</code>.
Argument passed to this function is an instance of <code>ScopeTrigger</code> class corresponding to a particular trigger type.
At minimum, every oscilloscope offers edge trigger where signal capture happens on either raising or
falling edge of signal. Other triggers can trigger signal capture on pulse evens, signal patterns and so on.
At the moment we only provide code for triggering on the signal edges.</p>
<p>Below is a minimal edge trigger configuration, which configures scope to trigger capture on the raising edge
of signal <code>ch3</code> (that is known as <em>trigger source</em>) when it crosses 0.5 volts level.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">inctrl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScopeTrigger</span>

<span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">ScopeTrigger</span><span class="o">.</span><span class="n">EDGE</span><span class="p">(</span><span class="n">trigger_source</span> <span class="o">=</span> <span class="n">ch3</span><span class="p">,</span> <span class="n">level_V</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">))</span>
</code></pre></div>
<p>Method <code>ScopeTrigger.EDGE(...)</code> has the following signature:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">EDGE</span><span class="p">(</span>
        <span class="n">trigger_source</span><span class="p">:</span> <span class="n">TriggerSource</span><span class="p">,</span>
        <span class="n">level_V</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">slope</span><span class="p">:</span> <span class="n">TriggerSlope</span> <span class="o">=</span> <span class="n">TriggerSlope</span><span class="o">.</span><span class="n">RISING</span><span class="p">,</span>
        <span class="n">delay</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="o">.</span><span class="n">value_of</span><span class="p">(</span><span class="s2">&quot;0 s&quot;</span><span class="p">)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScopeEdgeTrigger</span><span class="p">:</span>
</code></pre></div>
<p>As you can see default <code>slope</code> is <code>TriggerSlope.RISING</code> but you can change to <code>TriggerSlope.FALLING</code>.
Parameter <code>delay</code> refer to position on the screen when trigger is fired. Default value of 0 seconds places trigger
position in the middle of the screen, i.e. there is a same duration of captured signal before and after trigger.
Setting delay to positive value moves trigger position to the left, i.e. there is more data points captured after
the trigger than before. Setting delay to negative value moves trigger position to the right, i.e. there is fewer
data points captured after the trigger than before.</p>
<h4 id="operations">Operations<a class="headerlink" href="#operations" title="Permanent link">&para;</a></h4>
<p>Once trigger is configured you can arm the trigger to enable it. You can think of this as trigger modes.</p>
<p>For a single shot capture call</p>
<div class="highlight"><pre><span></span><code><span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">arm_single</span><span class="p">()</span>
</code></pre></div>
<p>This function is non-blocking and it might time a bit of time until trigger is actually armed. To check if trigger
is armed call</p>
<div class="highlight"><pre><span></span><code><span class="n">is_armed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">is_armed</span><span class="p">()</span>
</code></pre></div>
<p>To manually disarm trigger call</p>
<div class="highlight"><pre><span></span><code><span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">disarm</span><span class="p">()</span>
</code></pre></div>
<p>For continuous periodic capture call</p>
<div class="highlight"><pre><span></span><code><span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">arm_auto</span><span class="p">()</span>
</code></pre></div>
<p>For normal capture</p>
<div class="highlight"><pre><span></span><code><span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">arm_normal</span><span class="p">()</span>
</code></pre></div>
<p>Once trigger is fired and waveforms are available they can be downloaded from the scope.
To check if waveforms are available call</p>
<div class="highlight"><pre><span></span><code><span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">wait_for_waveform</span><span class="p">()</span>
</code></pre></div>
<p>Call like above will block indefinitely until trigger is fired and waveform is available for downloading.
Other optional arguments to this function can modify this behaviour. Signature for this function is</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wait_for_waveform</span><span class="p">(</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Duration</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">error_on_timeout</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>
<p>If <code>timeout</code> is not provided, then block wait indefinitely. If <code>timeout</code> is provided, then wait for that duration and
(if <code>error_on_timeout</code> is False (default)) return True or False if waveform is actually available for downloading, or,
if <code>error_on_timeout</code> is True, then raise RuntimeError after requested duration or return True on success.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<h4 id="capturing-i2c-data">Capturing I2C data<a class="headerlink" href="#capturing-i2c-data" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">inctrl</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScopeTrigger</span><span class="p">,</span> <span class="n">oscilloscope</span><span class="p">,</span> <span class="n">TriggerSlope</span>

<span class="c1"># Obtain handle to the connected oscilloscope</span>
<span class="n">scope</span> <span class="o">=</span> <span class="n">oscilloscope</span><span class="p">(</span><span class="s2">&quot;$address&quot;</span><span class="p">)</span>

<span class="c1"># We want to capture a 20 us waveform, hence we set time window </span>
<span class="c1"># to a bit larger value</span>
<span class="n">scope</span><span class="o">.</span><span class="n">set_time_window</span><span class="p">(</span><span class="s2">&quot;23 us&quot;</span><span class="p">)</span>

<span class="c1"># Channel 1 refers to SCL (system clock) line</span>
<span class="n">scl</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">channel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">scl</span><span class="o">.</span><span class="n">set_impedance_max</span><span class="p">()</span>

<span class="c1"># Channel 1 refers to SDC (data) line</span>
<span class="n">sdc</span> <span class="o">=</span> <span class="n">scope</span><span class="o">.</span><span class="n">channel</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sdc</span><span class="o">.</span><span class="n">set_impedance_max</span><span class="p">()</span>

<span class="c1"># Signals will be from 0 to 3.3 V. Setting range from -0.2 to 4 volts</span>
<span class="c1"># will ensure that all data is captured including noise.</span>
<span class="n">scl</span><span class="o">.</span><span class="n">set_range_V</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">sdc</span><span class="o">.</span><span class="n">set_range_V</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">ScopeTrigger</span><span class="o">.</span><span class="n">EDGE</span><span class="p">(</span>
    <span class="c1"># trigger on voltage change in data line</span>
    <span class="n">trigger_source</span> <span class="o">=</span> <span class="n">sdc</span><span class="p">,</span>

    <span class="c1"># trigger when voltage crosses 1.6 volt on the way down</span>
    <span class="c1"># to 0 from 3.3 volts</span>
    <span class="n">level_V</span> <span class="o">=</span> <span class="mf">1.6</span><span class="p">,</span>

    <span class="c1"># we are interested in mosty what happens after the trigger point</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="s2">&quot;20 us&quot;</span><span class="p">,</span>

    <span class="c1"># capture on the falling edge as by default signal is pulled up</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">TriggerSlope</span><span class="o">.</span><span class="n">FALLING</span>
<span class="p">))</span>

<span class="c1"># arm trigger, download waveforms and save them to files.</span>
<span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">arm_single</span><span class="p">()</span>
<span class="n">scope</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">wait_for_waveform</span><span class="p">(</span><span class="s2">&quot;10 s&quot;</span><span class="p">,</span> <span class="n">error_on_timeout</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">csl_waveform</span> <span class="o">=</span> <span class="n">scl</span><span class="o">.</span><span class="n">get_waveform</span><span class="p">()</span>
<span class="n">sdc_waveform</span> <span class="o">=</span> <span class="n">sdc</span><span class="o">.</span><span class="n">get_waveform</span><span class="p">()</span>
<span class="n">csl_waveform</span><span class="o">.</span><span class="n">save_to_file</span><span class="p">(</span><span class="s2">&quot;csl.wfm&quot;</span><span class="p">)</span>
<span class="n">sdc_waveform</span><span class="o">.</span><span class="n">save_to_file</span><span class="p">(</span><span class="s2">&quot;sdc.wfm&quot;</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>